<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Loot Matrix</title>
    <link rel="icon" href="../SAGE Editor Suite/Icon.png" type="image/png">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">        <header>            <div class="tabs">                <button class="tab-button active" data-tab="rewardsList">Loot Matrix</button>                <button class="tab-button" data-tab="categories">Categories</button>            </div>            <a href="../SAGE Editor Suite/index.html" class="home-button" title="Return to SAGE Editor Suite">                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">                    <path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>                </svg>                Home            </a>        </header>
        
        <div class="tab-content">
            <div id="rewardsList" class="tab-pane active">
                <div class="panel-header">
                    <div class="panel-controls">
                        <button id="newButton" title="New Document">New</button>
                        <button id="saveButton" title="Save (Ctrl+S)">Save</button>
                        <button id="loadButton" title="Load">Load</button>
                        <input type="file" id="fileInput" style="display: none;">
                        <button id="expandAllButton" title="Expand All">Expand All</button>
                        <button id="collapseAllButton" title="Collapse All">Collapse All</button>
                        <button id="selectAllButton" title="Select All">Select All</button>
                        <button id="deselectAllButton" title="Deselect All">Deselect All</button>
                        <button id="processCategoryPromotions" title="Process Category Promotions">Process Categories</button>
                        <button id="bulkOperationsButton" title="Bulk Operations" style="display:none;">Bulk Operations</button>
                        <button id="exportMarkdown" title="Export to Markdown" class="header-button">Export Markdown</button>
                    </div>
                    <div class="document-info">
                        <button id="keyboardHintButton" title="Keyboard Shortcuts" class="icon-button">?</button>
                        <div class="theme-toggle">
                            <label for="themeSwitch">
                                <input type="checkbox" id="themeSwitch">
                                <span class="theme-slider"></span>
                            </label>
                        </div>
                        <div class="width-toggle" title="Toggle Full Width">
                            <label for="widthSwitch">
                                <input type="checkbox" id="widthSwitch">
                                <span class="width-slider"></span>
                            </label>
                        </div>
                        <span id="autoSaveStatus">Unsaved changes</span>
                        <span id="documentName">all-rewards</span>
                    </div>
                </div>
                <div class="split-view">
                    <div class="reward-tree panel">
                        <div class="panel-header">
                            <h2>Reward Structure <span id="itemCount" class="item-count">(0 items)</span></h2>
                            <div class="panel-controls">
                                <button id="addRootItem" title="Add Root Item">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 3V13" stroke="currentColor" stroke-width="2" stroke-linecap="square"/>
                                        <path d="M3 8H13" stroke="currentColor" stroke-width="2" stroke-linecap="square"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="panel-content">
                            <div id="rewardTreeContainer"></div>
                        </div>
                    </div>
                    <div class="resize-handle" id="panelResizeHandle"></div>
                    <div class="properties-panel panel">
                        <div class="panel-header">
                            <h2>Properties</h2>
                            <div class="panel-controls">
                                <button id="scrollTopButton" title="Scroll to Top">
                                    <svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
                                        <path d="M8 3L3 8H13L8 3Z" fill="currentColor"/>
                                    </svg>
                                </button>
                            </div>
                        </div>
                        <div class="panel-content">
                            <div id="propertiesForm">
                                <p>Select an item to edit its properties</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="categories" class="tab-pane">
                <div class="panel-header">
                    <div class="panel-controls">
                        <button id="addColumn" title="Add Column">Add Column</button>
                        <button id="addRow" title="Add Row">Add Row</button>
                        <button id="importCSV" title="Import CSV">Import CSV</button>
                        <button id="exportCategoriesCSV" title="Export CSV">Export CSV</button>
                        <input type="file" id="csvFileInput" accept=".csv" style="display: none;">
                    </div>
                    <div class="document-info">
                        <button id="keyboardHintButton2" title="Keyboard Shortcuts" class="icon-button">?</button>
                        <div class="theme-toggle">
                            <label for="themeSwitch">
                                <input type="checkbox" id="themeSwitch">
                                <span class="theme-slider"></span>
                            </label>
                        </div>
                        <div class="width-toggle" title="Toggle Full Width">
                            <label for="widthSwitch">
                                <input type="checkbox" id="widthSwitch">
                                <span class="width-slider"></span>
                            </label>
                        </div>
                        <span id="autoSaveStatus2">Unsaved changes</span>
                        <span id="documentName2">all-rewards</span>
                    </div>
                </div>
                <div class="top-scroll-container">
                    <div class="top-scroll-content"></div>
                </div>
                <div class="spreadsheet-container">
                    <table id="categoriesTable">
                        <thead>
                            <tr id="headerRow">
                                <th>Item Name</th>
                            </tr>
                        </thead>
                        <tbody id="tableBody">
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Help / Shortcuts modal (enhanced) -->
    <div id="keyboardShortcutsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Loot Matrix Help</h2>
                <span class="close" id="closeModal">&times;</span>
            </div>
            <div class="modal-body">
                <div class="help-tabs">
                    <button class="help-tab active" data-tab="quickstart">Quick Start</button>
                    <button class="help-tab" data-tab="shortcuts">Keyboard Shortcuts</button>
                    <button class="help-tab" data-tab="mouse">Mouse & UI</button>
                </div>

                <div class="help-content">
                    <div id="quickstart-content" class="tab-content active">
                        <h4>Getting Started</h4>
                        <div class="help-section">
                            <h5>Basic Workflow</h5>
                            <ol>
                                <li><strong>Create Items</strong>: Use New/Add Root Item to start your reward tree</li>
                                <li><strong>Structure</strong>: Add children, duplicate, and drag to reorder</li>
                                <li><strong>Edit Properties</strong>: Select an item to edit details in the Properties panel</li>
                                <li><strong>Categories</strong>: Switch to Categories tab for spreadsheet-style editing</li>
                                <li><strong>Save/Load</strong>: Use Save to download JSON, Load to import</li>
                            </ol>
                        </div>

                        <div class="help-section">
                            <h5>Key Features</h5>
                            <ul>
                                <li><strong>Bulk Operations</strong>: Expand/Collapse All, Select/Deselect All</li>
                                <li><strong>Command Palette</strong>: Press Ctrl+P to search and run commands</li>
                                <li><strong>Markdown Export</strong>: Export the reward tree to Markdown</li>
                                <li><strong>Auto Backup</strong>: Periodic local backups with quick restore</li>
                            </ul>
                        </div>

                        <div class="help-section">
                            <h5>Tips</h5>
                            <ul>
                                <li>Use Alt+N to quickly add items at the current level</li>
                                <li>Right-click an item for context actions (add child, duplicate, delete)</li>
                                <li>Use arrow keys to navigate and expand/collapse the tree</li>
                                <li>Categories tab supports CSV import/export for bulk edits</li>
                            </ul>
                        </div>
                    </div>

                    <div id="shortcuts-content" class="tab-content">
                        <div class="shortcut-section">
                            <h4>Document</h4>
                            <div class="shortcut-grid">
                                <div class="shortcut-item"><span class="shortcut-keys">Ctrl + S</span><span class="shortcut-description">Save</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Ctrl + N</span><span class="shortcut-description">New blank document</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Ctrl + Shift + N</span><span class="shortcut-description">New blank document (alt)</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Ctrl + P</span><span class="shortcut-description">Open command palette</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">?</span><span class="shortcut-description">Toggle help</span></div>
                            </div>
                        </div>

                        <div class="shortcut-section">
                            <h4>Editing</h4>
                            <div class="shortcut-grid">
                                <div class="shortcut-item"><span class="shortcut-keys">Alt + N</span><span class="shortcut-description">Add item</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Delete</span><span class="shortcut-description">Delete selected</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Ctrl + Z</span><span class="shortcut-description">Undo</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Ctrl + Y / Ctrl + Shift + Z</span><span class="shortcut-description">Redo</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Ctrl + A</span><span class="shortcut-description">Select all</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Esc</span><span class="shortcut-description">Deselect all</span></div>
                            </div>
                        </div>

                        <div class="shortcut-section">
                            <h4>Navigation</h4>
                            <div class="shortcut-grid">
                                <div class="shortcut-item"><span class="shortcut-keys">↑ / ↓</span><span class="shortcut-description">Move selection</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">→</span><span class="shortcut-description">Expand selected</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">←</span><span class="shortcut-description">Collapse selected</span></div>
                            </div>
                        </div>
                    </div>

                    <div id="mouse-content" class="tab-content">
                        <div class="shortcut-section">
                            <h4>Tree & Properties</h4>
                            <div class="shortcut-grid">
                                <div class="shortcut-item"><span class="shortcut-keys">Left Click</span><span class="shortcut-description">Select item</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Double Click</span><span class="shortcut-description">Edit name</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Right Click</span><span class="shortcut-description">Open context menu</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">Drag</span><span class="shortcut-description">Reorder/move items</span></div>
                            </div>
                        </div>

                        <div class="shortcut-section">
                            <h4>Categories Spreadsheet</h4>
                            <div class="shortcut-grid">
                                <div class="shortcut-item"><span class="shortcut-keys">Click Header</span><span class="shortcut-description">Select column</span></div>
                                <div class="shortcut-item"><span class="shortcut-keys">CSV Import/Export</span><span class="shortcut-description">Bulk edit via CSV</span></div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Context Menu Template -->
    <div id="contextMenuTemplate" class="context-menu" style="display: none;">
        <div class="context-menu-item" data-action="add">Add Child</div>
        <div class="context-menu-item" data-action="edit">Edit Name</div>
        <div class="context-menu-item" data-action="duplicate">Duplicate</div>
        <div class="context-menu-item" data-action="delete">Delete</div>
        <div class="context-menu-item" data-action="expand-all">Expand All Children</div>
        <div class="context-menu-item" data-action="collapse-all">Collapse All Children</div>
    </div>

    <!-- Command Palette -->
    <div class="command-palette" id="commandPalette">
        <div class="command-palette-header">
            <input type="text" id="commandInput" placeholder="Type a command...">
        </div>
        <div class="command-palette-results" id="commandResults">
            <!-- Commands will be populated here -->
        </div>
    </div>
    
    <!-- Auto-backup Notification -->
    <div class="auto-backup-notification" id="autoBackupNotification">
        <div class="auto-backup-info">
            <span id="backupStatus">Auto-backup saved</span>
            <span id="backupTime"></span>
        </div>
        <button id="restoreBackup">Restore</button>
        <button id="closeBackupNotification">×</button>
    </div>
    
    <!-- Markdown Export Modal -->
    <div id="markdownModal" class="modal">
        <div class="modal-content markdown-modal-content">
            <div class="modal-header markdown-modal-header">
                <h2>Export to Markdown</h2>
                <span class="close" id="closeMarkdownBtn">&times;</span>
            </div>
            <div class="modal-body">
                <pre id="markdownText" class="markdown-text"></pre>
                <div class="markdown-modal-footer">
                    <button id="copyMarkdownBtn" class="copy-markdown">Copy to Clipboard</button>
                    <button id="closeMarkdownModalBtn" class="close-markdown-modal">Close</button>
                </div>
            </div>
        </div>
    </div>
    
    <div id="backupNotification" class="notification">
        <p>Your document has been backed up to localStorage.</p>
        <button id="closeBackupNotification">×</button>
    </div>
     
    <script src="app.js"></script>
</body>
</html> 